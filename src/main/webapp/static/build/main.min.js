"use strict";var app=angular.module("app",["ngRoute","ngTable","datepicker"],function(e){e.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8";var t=function(e){var r,n,s,o,a,i,c,l="";for(r in e)if(n=e[r],n instanceof Array)for(c=0;c<n.length;++c)a=n[c],s=r+"["+c+"]",i={},i[s]=a,l+=t(i)+"&";else if(n instanceof Object)for(o in n)a=n[o],s=r+"["+o+"]",i={},i[s]=a,l+=t(i)+"&";else void 0!==n&&null!==n&&(l+=encodeURIComponent(r)+"="+encodeURIComponent(n)+"&");return l.length?l.substr(0,l.length-1):l};e.defaults.transformRequest=[function(e){return angular.isObject(e)&&"[object File]"!==String(e)?t(e):e}]});app.controller("MainCtrl",function(e,t){e.to=function(e){t.path(e)}}),app.controller("IndexCtrl",function(e,t,r){r.menu="#"});var fdRouterViewsBasepath="static/app/modules/";app.config(["$routeProvider",function(e){e.when("/",{templateUrl:fdRouterViewsBasepath+"index/views/index.html",controller:"IndexCtrl"}).when("/custommgr/list",{templateUrl:fdRouterViewsBasepath+"custom/views/custommgrlist.html",controller:"CustomMgrListCtrl"}).when("/custommgr/incustom",{templateUrl:fdRouterViewsBasepath+"custom/views/custommgrincustom.html",controller:"CustomMgrInCustomCtrl"}).when("/custommgr/editcustom/:id",{templateUrl:fdRouterViewsBasepath+"custom/views/custommgrincustom.html",controller:"CustomMgrInCustomCtrl"}).when("/custommgr/viewcustom/:id",{templateUrl:fdRouterViewsBasepath+"custom/views/custommgrviewcustom.html",controller:"CustomMgrViewCustomCtrl"}).when("/jobmgr/list",{templateUrl:fdRouterViewsBasepath+"job/views/jobmgrlist.html",controller:"JobMgrListCtrl"}).when("/jobmgr/injob",{templateUrl:fdRouterViewsBasepath+"job/views/jobmgrinjob.html",controller:"JobMgrInCustomCtrl"}).when("/jobmgr/editjob/:id",{templateUrl:fdRouterViewsBasepath+"job/views/jobmgrinjob.html",controller:"JobMgrInJobCtrl"}).when("/jobmgr/viewjob/:id",{templateUrl:fdRouterViewsBasepath+"custom/views/jobmgrviewjob.html",controller:"JobMgrViewJobCtrl"}).when("/resumemgr/list",{templateUrl:fdRouterViewsBasepath+"resume/views/resumemgrlist.html",controller:"ResumeMgrListCtrl"}).when("/resumemgr/inresume",{templateUrl:fdRouterViewsBasepath+"resume/views/resumemgrinresume.html",controller:"ResumeMgrInResumeCtrl"}).when("/resumemgr/editcustom/:id",{templateUrl:fdRouterViewsBasepath+"resume/views/resumemgrinresume.html",controller:"ResumeMgrInResumeCtrl"}).when("/resumemgr/viewresume/:id",{templateUrl:fdRouterViewsBasepath+"custom/views/resumemgrviewresume.html",controller:"ResumeMgrViewResumeCtrl"}).when("/contractmgr/list",{templateUrl:fdRouterViewsBasepath+"contract/views/contractmgrlist.html",controller:"ContractMgrListCtrl"}).when("/contractmgr/incontract",{templateUrl:fdRouterViewsBasepath+"contract/views/contractmgrincontract.html",controller:"ContractMgrInContractCtrl"}).when("/contractmgr/incontract/:customid",{templateUrl:fdRouterViewsBasepath+"contract/views/contractmgrincontract.html",controller:"ContractMgrInContractCtrl"}).when("/contractmgr/editcustom/:id",{templateUrl:fdRouterViewsBasepath+"contract/views/contractmgrincontract.html",controller:"ContractMgrInContractCtrl"}).when("/contractmgr/viewcontract/:id",{templateUrl:fdRouterViewsBasepath+"custom/views/contractmgrviewcontract.html",controller:"ContractMgrViewContractCtrl"}).when("/invoicemgr/list",{templateUrl:fdRouterViewsBasepath+"invoice/views/invoicemgrlist.html",controller:"InvoiceMgrListCtrl"}).when("/invoicemgr/ininvoice",{templateUrl:fdRouterViewsBasepath+"invoice/views/invoicemgrininvoice.html",controller:"InvoiceMgrInInvoiceCtrl"}).when("/invoicemgr/editcustom/:id",{templateUrl:fdRouterViewsBasepath+"invoice/views/invoicemgrininvoice.html",controller:"InvoiceMgrInInvoiceCtrl"}).when("/invoicemgr/viewinvoice/:id",{templateUrl:fdRouterViewsBasepath+"custom/views/invoicemgrviewinvoice.html",controller:"InvoiceMgrViewInvoiceCtrl"}).when("/performancemgr/list",{templateUrl:fdRouterViewsBasepath+"performance/views/performancemgrlist.html",controller:"PerformanceMgrListCtrl"}).when("/teammgr/list",{templateUrl:fdRouterViewsBasepath+"team/views/teammgrlist.html",controller:"TeamMgrListCtrl"}).when("/teammgr/myinfo",{templateUrl:fdRouterViewsBasepath+"team/views/teammgrmyinfo.html",controller:"TeamMgrMyInfoCtrl"}).when("/usermgr/list",{templateUrl:fdRouterViewsBasepath+"user/views/usermgrlist.html",controller:"UserMgrListCtrl"}).when("/usermgr/inuser",{templateUrl:fdRouterViewsBasepath+"user/views/usermgrinuser.html",controller:"UserMgrInUserCtrl"}).when("/usermgr/editcustom/:id",{templateUrl:fdRouterViewsBasepath+"user/views/usermgrinuser.html",controller:"UserMgrInUserCtrl"}).when("/usermgr/viewuser/:id",{templateUrl:fdRouterViewsBasepath+"custom/views/usermgrviewuser.html",controller:"UserMgrViewUserCtrl"}).when("/usermgr/resetpwd",{templateUrl:fdRouterViewsBasepath+"user/views/userresetpwd.html",controller:"UserResetPwdCtrl"}).when("/pubmgr/list",{templateUrl:fdRouterViewsBasepath+"pub/views/pubmgrlist.html",controller:"PubMgrListCtrl"}).when("/pubmgr/inpub",{templateUrl:fdRouterViewsBasepath+"pub/views/pubmgrinpub.html",controller:"PubMgrInPubCtrl"}).when("/pubmgr/editpub",{templateUrl:fdRouterViewsBasepath+"pub/views/pubmgreditpub.html",controller:"PubMgrEditPubCtrl"}).otherwise({redirectTo:"/"})}]),app.filter("trustHtml",function(e){return function(t){return e.trustAsHtml(t)}}),app.directive("coreBasedata",["$http",function(){var e={customIndustry:[["房地产开发/建筑与工程","房地产开发/建筑与工程"],["金融业(投资/保险/证券/银行/基金)","金融业(投资/保险/证券/银行/基金)"]],customSource:[["广告呼入","广告呼入"],["主动BD","主动BD"],["机构合作","机构合作"],["人脉推荐","人脉推荐"]],customState:[["潜在客户","潜在客户"],["签约运作","签约运作"],["签约暂停","签约暂停"],["签约终止","签约终止"]]};return{restrict:"A",scope:{value:"@value",type:"@type",key:"@key",name:"@name",bindModel:"=bindModel",allSelectName:"@allSelectName"},templateUrl:"static/app/components/directives/core/views/basedata.html",replace:!0,require:"?ngModel",link:function(t,r,n,s){t.items=e[t.key],t.click=function(e){s.$setViewValue(e)}}}}]),app.directive("coreFormresult",["$timeout",function(e){var t=null;return{restrict:"A",scope:{formresult:"=result"},templateUrl:"static/app/components/directives/core/views/formresult.html",link:function(r){r.$watch("formresult",function(){null!=r.formresult&&"1"==r.formresult.success&&(e.cancel(t),t=e(function(){r.formresult=null},4e3),r.$on("$destroy",function(){e.cancel(t)}))})}}}]),app.directive("corePermission",["BaseInfoService",function(e){return{restrict:"A",link:function(t,r,n){var s=r.style.display;r.style.display="none",e.getUserInfo(function(e){var t=!1,o=!1,a=e.userType;if("1"!=a){var i=n.roles.split(",");if(i.length>0)for(var c in i){var l=i[c];if(l==a){t=!0;break}}{n.funid}o=!0,t&&o&&(r.style.display=s)}else r.style.display=s})}}}]),app.directive("coreTeamselect",["$http",function(){return{restrict:"A",replace:!0,scope:{te:"=bindteam",teamselect:"=teamselect"},templateUrl:"static/app/components/directives/core/views/teamselect.html",link:function(e){function t(){var t=[],r=e.teamselect.select;for(var n in r)t.push(r[n].id);e.te=t.join(",")}e.addItem=function(r,n){e.teamselect.unSelect.splice(n,1),e.teamselect.select.push(r),t()},e.removeItem=function(r,n){e.teamselect.select.splice(n,1),e.teamselect.unSelect.push(r),t()}}}}]),angular.module("datepicker",[]).directive("datepicker",[function(){return{restrict:"A",require:"ngModel",link:function(e,t,r,n){$(function(){t.datepicker({dateFormat:"yy-mm-dd",onSelect:function(t){e.$apply(function(){n.$setViewValue(t)})}})})}}}]),app.factory("BaseInfoService",["$http","ngTableParams",function(e,t){var r=null;return{getUserInfo:function(t){r?data&&t(data):e.post("getLoginUser").success(function(e){e&&t(e)})},pageSearch:function(r){var n=r.$scope,s=r.params,o=r.url,a=r.page;void 0==a&&(a=10);r.items;s||(n[s]={});var i=new t({page:0,count:a},{total:0,getData:function(t,r){n[s].isreload?n[s].isreload=!1:(n[s].page=r.page(),n[s].rows=r.count(),n[s].total=r.total()),e.post(o,n[s]).success(function(e){var o=e.total;n[s].total=o,r.total(o),t.resolve(e.rows)})}});return i}}}]),app.controller("ContractMgrInContractCtrl",function(e,t,r,n,s,o){o.menu="contract"}),app.controller("ContractMgrListCtrl",function(e,t,r,n,s,o){o.menu="contract"}),app.controller("ContractMgrViewContractCtrl",function(e,t,r,n,s,o){o.menu="contract"}),app.factory("ContractService",["$http",function(e){return{test:function(t,r){e.post("formdesign/formdatadel",t).success(function(e){r&&r(e)})}}}]),app.controller("CustomMgrInCustomCtrl",function(e,t,r,n,s,o,a){function i(){t.post("custom/getCommuns",{customId:u}).success(function(t){e.communs=t})}function c(r){l()&&(e.isrequest=!0,t.post("custom/edit",e.custom).success(function(t){e.formresult=t,e.isrequest=!1,r&&r(t)}))}function l(){return $("#customeditform").isHappy({fields:{customName:{required:!0,maxlength:100},industry:{required:!0,maxlength:200}}})}o.menu="custom";var u=r.id;e.isReady=!1,u?t.post("custom/getCustomById",{id:u}).success(function(r){e.custom=r.custom,e.communs=r.communs,e.attachs=r.attachs,e.isReady=!0,t.post("team/getSelectTeams",{ids:e.custom.team}).success(function(t){e.teamselect=t})}):(e.isReady=!0,e.custom={state:"潜在客户"},t.post("team/getSelectTeams",{}).success(function(t){e.teamselect=t})),e.delCommun=function(r){t.post("custom/delCommun",{id:r.id}).success(function(t){e.formresult=t,i()})},e.save=function(){c(function(e){"1"==e.success&&a.path("custommgr/list")})},e.saveAndAddContract=function(){c(function(e){if("1"==e.success){var t=e.data;a.path("contractmgr/incontract/"+t)}})}}),app.controller("CustomMgrListCtrl",function(e,t,r,n,s,o){o.menu="custom";var a=1,i=10;e.search={},e.queryParams={rows:i},e.initParams=function(t){var r=a;t&&(r=e.queryParams.page);var n={page:r,rows:e.queryParams.rows,isreload:!0};angular.extend(n,e.search),angular.extend(e.queryParams,n)},e.initParams(),e.reload=function(t){e.initParams(t),e.tableParams.reload()},e.tableParams=new n({page:a,count:i},{total:0,getData:function(r,n){e.queryParams.isreload?e.queryParams.isreload=!1:(e.queryParams.page=n.page(),e.queryParams.rows=n.count(),e.queryParams.total=n.total()),t.post("custom/list",e.queryParams).success(function(t){var s=t.total;e.queryParams.total=s,n.total(s),n.page(e.queryParams.page),r.resolve(t.rows)})}}),e.$watch("search",function(t,r){t!=r&&e.reload()},!0),e.del=function(r){t.post("custom/del",{id:r.id}).success(function(t){e.formresult=t,e.reload(!0)})}}),app.controller("CustomMgrViewCustomCtrl",function(e,t,r,n,s,o){o.menu="custom";var a=r.id;e.isReady=!1,t.post("custom/getCustomViewById",{id:a}).success(function(t){e.custom=t.custom,e.comms=t.comms,e.attas=t.attas,e.jobs=t.jobs,e.teams=t.teams,t.contracts&&t.contracts.length>0&&(e.contract=t.contracts[0]),e.contractAttas=t.contractAttas,e.isReady=!0}),e.addComm=function(){}}),app.factory("CustomService",["$http",function(e){return{test:function(t,r){e.post("formdesign/formdatadel",t).success(function(e){r&&r(e)})}}}]),app.controller("FormDataListCtrl",function(e,t,r,n,s,o,a){var i=1,c=10;e.initParams=function(){e.queryParams={page:i,rows:c,formid:r.formid,isreload:!0}},e.initParams(),e.reload=function(){e.initParams(),e.tableParams.reload()},e.tableParams=new n({page:i,count:c},{total:0,getData:function(t,r){e.queryParams.isreload?e.queryParams.isreload=!1:(e.queryParams.page=r.page(),e.queryParams.rows=r.count(),e.queryParams.total=r.total()),s.queryList(e.queryParams,function(n){var s=n.pagingResult.total;e.queryParams.total=s,r.total(s),t.resolve(n.pagingResult.rows)})}}),e.del=function(t){confirm("确认删除?")!==!1&&(t.isdeling=!0,a.del({id:t.id},function(){e.reload()}))},o.queryFormById({id:r.formid},function(t){e.formtitle=t.formResult.data.title,e.formdtcreate=t.formResult.data.dtCreate,e.formdtupdate=t.formResult.data.dtUpdate,e.formdtpub=t.formResult.data.dtPub,e.formFields=t.formFields})}),app.controller("FormDesignCtrl",function(e,t,r){function n(e,t){var r=/(\|-<span(((?!<span).)*plugins=\"(radios|checkboxs|select)\".*?)>(.*?)<\/span>-\||<(img|input|textarea|select).*?(<\/select>|<\/textarea>|\/>))/gi,n=/(\w+)=\"(.?|.+?)\"/gi,s=/<input.*?\/>/gi;t||(t=0);var o=e,a=new Array,i=new Object,c=0,l=0;e.replace(r,function(r,u,m,d,p,f,g){var v=new Array,w=new Object,h="",y="",b=!1,C=r,P=g?g:p;if("radios"==P||"checkboxs"==P?r=m:"select"==P&&(r=r.replace("|-",""),r=r.replace("-|","")),r.replace(n,function(e,r,n){"name"==r&&("NEWFIELD"==n&&(b=!0,t++,n="data_"+t),h=n),"select"==P&&"value"==r?(w[r]||(w[r]=""),w[r]+=y+n,y=","):w[r]=n;var s=new Object;s[r]=n,v.push(s)}),"checkboxs"==P){r=C,r=r.replace("|-",""),r=r.replace("-|","");var h="checkboxs_"+c;w.parse_name=h,w.name="",w.value="",w.content='<span plugins="checkboxs" valids="'+w.valids+'">';var U="",q="";f.replace(s,function(e){var r=!1,s=new Object;e.replace(n,function(e,n,o){"name"==n?("NEWFIELD"==o&&(r=!0,t++,o="data_"+t),w.name+=U+o,U=","):"value"==n&&(w.value+=q+o,q=","),s[n]=o}),w.options||(w.options=new Array),w.options.push(s),s.checked||(s.checked="");var o=s.checked?'checked="checked"':"";if(w.content+='<input type="checkbox" name="'+s.name+'" value="'+s.value+'" fieldname="'+w.fieldname+s.fieldname+'"'+o+"/>"+s.value+"&nbsp;",r){var a=new Object;a.name=s.name,a.plugins=w.plugins,a.fieldname=w.fieldname+s.fieldname,a.fielddesc=w.orgdesc,a.valids=w.valids,i[s.name]=a}}),w.content+="</span>",e=e.replace(r,w.content),o=o.replace(r,"{"+h+"}"),o=o.replace("{|-",""),o=o.replace("-|}",""),a[l]=w,c++}else if(h){if("radios"==P){r=C,r=r.replace("|-",""),r=r.replace("-|",""),w.value="",w.content='<span plugins="radios" name="'+w.name+'" valids="'+w.valids+'">';var R="";f.replace(s,function(e){var t=new Object;e.replace(n,function(e,r,n){"value"==r&&(w.value+=R+n,R=","),t[r]=n}),t.name=w.name,w.options||(w.options=new Array),w.options.push(t),t.checked||(t.checked="");var r=t.checked?'checked="checked"':"";w.content+='<input type="radio" name="'+w.name+'" value="'+t.value+'"  '+r+"/>"+t.value+"&nbsp;"}),w.content+="</span>"}else w.content=b?r.replace(/NEWFIELD/,h):r;if(e=e.replace(r,w.content),o=o.replace(r,"{"+h+"}"),o=o.replace("{|-",""),o=o.replace("-|}",""),b){var M=new Object;M.name=h,M.plugins=w.plugins,M.orgtype=w.orgtype,M.fieldname=w.fieldname,M.fielddesc=w.orgdesc,M.valids=w.valids,i[M.name]=M}a[l]=w}l++});var u=e.replace(/{\|-/g,"");u=u.replace(/-\|}/g,"");var m=new Object({fields:t,template:e,parse:u,data:a,add_fields:i});return JSON.stringify(m)}t.id&&(e.id=t.id),UE.delEditor("formdesigncontainer");var s=null;s=UE.getEditor("formdesigncontainer",{toolleipi:!0,initialFrameWidth:1024,initialFrameHeight:200,enableAutoSave:!1,enableContextMenu:!0,toolbars:[["fullscreen","undo","redo","|","bold","italic","underline","fontborder","strikethrough","removeformat","|","forecolor","backcolor","insertorderedlist","insertunorderedlist","|","fontfamily","fontsize","|","indent","|","justifyleft","justifycenter","justifyright","justifyjustify","|","link","unlink","|","horizontal","spechars","wordimage","|","inserttable","deletetable","mergecells","splittocells","|"]],wordCount:!1,elementPathEnabled:!1}),s.addListener("ready",function(){t.id&&r.post("formdesign/getformbyid",{id:t.id}).success(function(t){e.title=t.formResult.data.title,s.execCommand("focus"),s.setContent(t.formResult.data.contentSrc)})}),e.exec=function(e){s.execCommand(e)},e.save=function(){if(0!=confirm("确认保存?注意：保存之后原始表单以及对应表单已上报数据会清空。")){if(s.queryCommandState("source")&&s.execCommand("source"),void 0===e.title)return void alert("标题不能为空");if(e.title.length>50)return void alert("标题长度不能大于50个字符");if(s.hasContents()){s.sync();var t=s.getContent(),o=JSON.parse(n(t,0));e.issaving=!0,r.post("formdesign/add",{title:e.title,content:o.parse,contentSrc:t,fields:JSON.stringify(o.add_fields),id:e.id}).success(function(t){"0"==t.formResult.success?alert(t.formResult.message):(e.id=t.formResult.data,alert("保存成功")),e.issaving=!1}).error(function(){alert("保存失败"),e.issaving=!1})}else alert("内容不能为空")}},e.preview=function(){if(s.queryCommandState("source")&&s.execCommand("source"),!s.hasContents())return alert("内容不能为空！"),!1;s.sync();var t=s.getContent(),r=n(t,0);e.designZone=JSON.parse(r).parse,e.isDesignZoneActive=!0}}),app.controller("FormDesignListCtrl",function(e,t,r,n,s){e.reset=function(){e.searchTitle=null,e.dtCreateBegin=null,e.dtCreateEnd=null,e.dtPubBegin=null,e.dtPubEnd=null,e.ispub=null,e.pubtype=null};var o=1,a=10;e.queryParams={page:o,rows:a,isreload:!0},e.reload=function(){e.queryParams={page:e.queryParams.page,rows:e.queryParams.rows,dtcreate_begin:e.dtCreateBegin,dtcreate_end:e.dtCreateEnd,dtpub_begin:e.dtPubBegin,dtpub_end:e.dtPubEnd,ispub:e.ispub,title:e.searchTitle,pubtype:e.pubtype,isreload:!0},e.tableParams.reload()},e.tableParams=new r({page:o,count:a},{total:0,getData:function(t,r){e.queryParams.isreload?e.queryParams.isreload=!1:(e.queryParams.page=r.page(),e.queryParams.rows=r.count(),e.queryParams.total=r.total()),n.queryList(e.queryParams,function(n){var s=n.pagingResult.total;e.queryParams.total=s,r.total(s),t.resolve(n.pagingResult.rows)})}}),e.pub=function(t,r){s.pub({id:t,type:r},function(){e.reload()})},e.canclepub=function(t){s.canclepub({id:t},function(){e.reload()})},e.del=function(t){confirm("确认删除?")!==!1&&(t.isdeling=!0,s.del({id:t.id},function(){e.reload()}))}}),app.factory("FormDataListService",["$http",function(e){return{queryList:function(t,r){e.post("formdesign/getformdatas",t).success(function(e){var t=[],n=e.pagingResult.rows;if(n&&n.length>0)for(var s in n){var o=n[s];t.push({id:o.id,dt_create:o.dt_create,form_data:JSON.parse(o.form_data)})}e.pagingResult.rows=t,r&&r(e)})}}}]),app.factory("FormDataService",["$http",function(e){return{del:function(t,r){e.post("formdesign/formdatadel",t).success(function(e){r&&r(e)})}}}]),app.factory("FormDesignListService",["$http",function(e){return{queryList:function(t,r){e.post("formdesign/getforms",t).success(function(e){r&&r(e)})}}}]),app.factory("FormDesignService",["$http",function(e){return{queryFormById:function(t,r){e.post("formdesign/getformbyid",t).success(function(e){var t=JSON.parse(e.formResult.data.fields),n=[],s=5,o=0;$.each(t,function(e,t){return o>=s?!1:(o++,void(t&&t.fielddesc&&n.push({name:e,desc:t.fielddesc})))}),e.formFields=n,r&&r(e)})},del:function(t,r){e.post("formdesign/del",t).success(function(e){r&&r(e)})},pub:function(t,r){e.post("formdesign/pub",t).success(function(e){r&&r(e)})},canclepub:function(t,r){e.post("formdesign/canclepub",t).success(function(e){r&&r(e)})}}}]),app.controller("InvoiceMgrInInvoiceCtrl",function(e,t,r,n,s,o){o.menu="invoice"}),app.controller("InvoiceMgrListCtrl",function(e,t,r,n,s,o){o.menu="invoice"}),app.controller("InvoiceMgrViewInvoiceCtrl",function(e,t,r,n,s,o){o.menu="invoice"}),app.factory("InvoiceService",["$http",function(e){return{test:function(t,r){e.post("formdesign/formdatadel",t).success(function(e){r&&r(e)})}}}]),app.controller("JobMgrInJobCtrl",function(e,t,r,n,s,o){o.menu="job"}),app.controller("JobMgrListCtrl",function(e,t,r,n,s,o){o.menu="job"}),app.controller("JobMgrViewJobCtrl",function(e,t,r,n,s,o){o.menu="job"}),app.factory("JobService",["$http",function(e){return{test:function(t,r){e.post("formdesign/formdatadel",t).success(function(e){r&&r(e)})}}}]),app.controller("PerformanceMgrListCtrl",function(e,t,r,n,s,o){o.menu="performance"}),app.factory("PerformanceService",["$http",function(e){return{test:function(t,r){e.post("formdesign/formdatadel",t).success(function(e){r&&r(e)})}}}]),app.factory("PubService",["$http",function(e){return{test:function(t,r){e.post("formdesign/formdatadel",t).success(function(e){r&&r(e)})}}}]),app.controller("PubMgrInPubCtrl",function(e,t,r,n,s,o){o.menu="pub"}),app.controller("PubMgrListCtrl",function(e,t,r,n,s,o){o.menu="pub"}),app.controller("ResumeMgrInResumeCtrl",function(e,t,r,n,s,o){o.menu="resume"}),app.controller("ResumeMgrListCtrl",function(e,t,r,n,s,o){o.menu="resume"}),app.controller("ResumeMgrViewResumeCtrl",function(e,t,r,n,s,o){o.menu="resume"}),app.factory("ResumeService",["$http",function(e){return{test:function(t,r){e.post("formdesign/formdatadel",t).success(function(e){r&&r(e)})}}}]),app.controller("TeamMgrListCtrl",function(e,t,r,n,s,o){o.menu="team"}),app.controller("TeamMgrMyInfoCtrl",function(e,t,r,n,s,o){o.menu="team"}),app.factory("TeamService",["$http",function(e){return{test:function(t,r){e.post("formdesign/formdatadel",t).success(function(e){r&&r(e)})}}}]),app.controller("UserMgrEditUserCtrl",function(e,t,r,n,s){t.id?(s.nav=n.geNav([["用户管理","/usermgr/list"],["用户编辑"]]),e.id=t.id,r.post("usermgr/getUserById",{id:e.id}).success(function(t){t.createTime=null,t.updateTime=null,e.user=t})):(s.nav=n.geNav([["用户管理","/usermgr/list"],["用户新增"]]),n.getUserInfo(function(t){e.user={userType:"1"==t.userType?"2":"3"}})),e.saveUser=function(){e.formresult=null;var t=$("#usermgr-list-form").isHappy({fields:{loginName:{required:!0,maxlength:20,minlength:6,username:!0},userName:{required:!0,maxlength:20},birthday:{dateISO:!0},orgCode:{required:!0,maxlength:40},department:{required:!0,maxlength:100},comment:{maxlength:100}}});t&&(e.isrequest=!0,r.post("usermgr/editUser",e.user).success(function(t){e.formresult=t,t.data&&(e.user.id=t.data.id),e.isrequest=!1}))}}),app.controller("UserMgrInUserCtrl",function(e,t,r,n,s,o){o.menu="user"}),app.controller("UserMgrListCtrl",function(e,t,r,n,s,o){s.nav=o.geNav([["用户管理"]]);var a=1,i=10;e.queryParams={page:a,rows:i,isreload:!0},e.reload=function(){e.queryParams={page:e.queryParams.page,rows:e.queryParams.rows,username:e.searchUserName,loginname:e.searchLoginName,usertype:e.searchUserType,isDisabled:e.searchIsDisabled,isreload:!0},e.tableParams.reload()},e.tableParams=new n({page:a,count:i},{total:0,getData:function(t,n){e.queryParams.isreload?e.queryParams.isreload=!1:(e.queryParams.page=n.page(),e.queryParams.rows=n.count(),e.queryParams.total=n.total()),r.post("usermgr/getUserList",e.queryParams).success(function(r){var s=r.total;e.queryParams.total=s,n.total(s),t.resolve(r.rows)})}}),e.delUser=function(t){confirm("确认删除?")!==!1&&r.post("usermgr/delUser",{id:t.id}).success(function(){e.reload()})},e.disabledUser=function(t){confirm("确认锁定?")!==!1&&r.post("usermgr/disabledUser",{id:t.id}).success(function(){e.reload()})},e.enableUser=function(t){r.post("usermgr/enableUser",{id:t.id}).success(function(){e.reload()})},e.resetPwd=function(t){confirm("确认重置用户密码?")!==!1&&r.post("usermgr/pwdReset",{id:t.id}).success(function(t){e.reload(),e.formresult=t})}}),app.controller("UserMgrViewUserCtrl",function(e,t,r,n,s,o){o.menu="user"}),app.controller("UserPwdResetCtrl",function(e,t,r,n){n.nav=r.geNav([["用户"],["修改密码"]]),e.resetPwd=function(){e.formresult=null;var r=$("#user-pwdreset-form").isHappy({fields:{oldPwd:{required:!0,pwd:!0},newPwd:{required:!0,pwd:!0},newPwdRepeat:{required:!0,pwd:!0}}});r&&(e.isrequest=!0,t.post("user/pwdReset",e.pwd).success(function(t){e.formresult=t,e.isrequest=!1}))}}),app.controller("UserResetPwdCtrl",function(e,t,r,n,s,o){o.menu="resetpwd"}),app.factory("UserService",["$http",function(e){return{test:function(t,r){e.post("formdesign/formdatadel",t).success(function(e){r&&r(e)})}}}]),app.controller("UserMgrEditUserCtrl",function(e,t,r,n){t.id?(e.id=t.id,r.post("usermgr/getUserById",{id:e.id}).success(function(t){t.createTime=null,t.updateTime=null,e.user=t})):n.getUserInfo(function(t){e.user={userType:"1"==t.userType?"2":"3"}}),e.saveUser=function(){e.formresult=null;var t=$("#usermgr-list-form").isHappy({fields:{loginName:{required:!0,maxlength:20},userName:{required:!0,maxlength:20},birthday:{dateISO:!0},orgCode:{maxlength:40},department:{maxlength:100},comment:{maxlength:100}}});t&&(e.isrequest=!0,r.post("usermgr/editUser",e.user).success(function(t){e.formresult=t,t.data&&(e.user.id=t.data.id),e.isrequest=!1}))}}),app.controller("UserMgrListCtrl",function(e,t,r,n){var s=1,o=10;e.queryParams={page:s,rows:o,isreload:!0},e.reload=function(){e.queryParams={page:e.queryParams.page,rows:e.queryParams.rows,username:e.searchUserName,loginname:e.searchLoginName,usertype:e.searchUserType,isDisabled:e.searchIsDisabled,isreload:!0},e.tableParams.reload()},e.tableParams=new n({page:s,count:o},{total:0,getData:function(t,n){e.queryParams.isreload?e.queryParams.isreload=!1:(e.queryParams.page=n.page(),e.queryParams.rows=n.count(),e.queryParams.total=n.total()),r.post("usermgr/getUserList",e.queryParams).success(function(r){var s=r.total;e.queryParams.total=s,n.total(s),t.resolve(r.rows)})}}),e.delUser=function(t){confirm("确认删除?")!==!1&&r.post("usermgr/delUser",{id:t.id}).success(function(){e.reload()})},e.disabledUser=function(t){confirm("确认锁定?")!==!1&&r.post("usermgr/disabledUser",{id:t.id}).success(function(){e.reload()})},e.enableUser=function(t){r.post("usermgr/enableUser",{id:t.id}).success(function(){e.reload()})}});