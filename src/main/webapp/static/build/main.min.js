"use strict";var app=angular.module("app",["ngRoute","ngTable","datepicker"],function(e){e.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8";var t=function(e){var r,a,s,o,n,i,u,c="";for(r in e)if(a=e[r],a instanceof Array)for(u=0;u<a.length;++u)n=a[u],s=r+"["+u+"]",i={},i[s]=n,c+=t(i)+"&";else if(a instanceof Object)for(o in a)n=a[o],s=r+"["+o+"]",i={},i[s]=n,c+=t(i)+"&";else void 0!==a&&null!==a&&(c+=encodeURIComponent(r)+"="+encodeURIComponent(a)+"&");return c.length?c.substr(0,c.length-1):c};e.defaults.transformRequest=[function(e){return angular.isObject(e)&&"[object File]"!==String(e)?t(e):e}]}),reloadPageFlag=!1;app.factory("ajaxHandler",["$q","$rootScope",function(e,t){var r={responseError:function(r){var a=r.status,s="";switch(parseInt(a)){case 400:s="请求错误";break;case 401:var o=3;s="登陆超时,"+o+"秒后自动跳转登陆页面...",reloadPageFlag||(reloadPageFlag=!0,setTimeout(function(){window.location.reload()},1e3*o));break;case 403:s="无访问权限";break;case 404:s="未知请求";break;case 500:s="操作失败,服务器异常";break;case 302:var o=3;s="登陆超时,"+o+"秒后自动跳转登陆页面...",reloadPageFlag||(reloadPageFlag=!0,setTimeout(function(){window.location.reload()},1e3*o));break;case 0:s="无法连接服务器";break;default:s="未知错误"}return t.ajaxerror={success:0,message:s,time:new Date},e.reject(r)}};return r}]),app.config(["$httpProvider",function(e){e.interceptors.push("ajaxHandler")}]),app.controller("MainCtrl",function(e,t,r){e.to=function(e){t.path(e)},r.post("user/getLoginUserInfo",{}).success(function(t){e.user=t})});var fdRouterViewsBasepath="static/app/modules/";app.config(["$routeProvider",function(e){e.when("/",{templateUrl:fdRouterViewsBasepath+"index/views/index.html",controller:"IndexCtrl"}).when("/custommgr/list",{templateUrl:fdRouterViewsBasepath+"custom/views/custommgrlist.html",controller:"CustomMgrListCtrl"}).when("/custommgr/incustom",{templateUrl:fdRouterViewsBasepath+"custom/views/custommgrincustom.html",controller:"CustomMgrInCustomCtrl"}).when("/custommgr/editcustom/:id",{templateUrl:fdRouterViewsBasepath+"custom/views/custommgrincustom.html",controller:"CustomMgrInCustomCtrl"}).when("/custommgr/viewcustom/:id",{templateUrl:fdRouterViewsBasepath+"custom/views/custommgrviewcustom.html",controller:"CustomMgrViewCustomCtrl"}).when("/jobmgr/list",{templateUrl:fdRouterViewsBasepath+"job/views/jobmgrlist.html",controller:"JobMgrListCtrl"}).when("/jobmgr/injob",{templateUrl:fdRouterViewsBasepath+"job/views/jobmgrinjob.html",controller:"JobMgrInJobCtrl"}).when("/jobmgr/injob/:customId",{templateUrl:fdRouterViewsBasepath+"job/views/jobmgrinjob.html",controller:"JobMgrInJobCtrl"}).when("/jobmgr/editjob/:id",{templateUrl:fdRouterViewsBasepath+"job/views/jobmgrinjob.html",controller:"JobMgrInJobCtrl"}).when("/jobmgr/viewjob/:id",{templateUrl:fdRouterViewsBasepath+"job/views/jobmgrviewjob.html",controller:"JobMgrViewJobCtrl"}).when("/resumemgr/list",{templateUrl:fdRouterViewsBasepath+"resume/views/resumemgrlist.html",controller:"ResumeMgrListCtrl"}).when("/resumemgr/inresume",{templateUrl:fdRouterViewsBasepath+"resume/views/resumemgrinresume.html",controller:"ResumeMgrInResumeCtrl"}).when("/resumemgr/editresume/:id",{templateUrl:fdRouterViewsBasepath+"resume/views/resumemgrinresume.html",controller:"ResumeMgrInResumeCtrl"}).when("/resumemgr/viewresume/:id",{templateUrl:fdRouterViewsBasepath+"resume/views/resumemgrviewresume.html",controller:"ResumeMgrViewResumeCtrl"}).when("/resumemgr/pub/:id",{templateUrl:fdRouterViewsBasepath+"resume/views/resumepublist.html",controller:"ResumePubListCtrl"}).when("/contractmgr/list",{templateUrl:fdRouterViewsBasepath+"contract/views/contractmgrlist.html",controller:"ContractMgrListCtrl"}).when("/contractmgr/incontract",{templateUrl:fdRouterViewsBasepath+"contract/views/contractmgrincontract.html",controller:"ContractMgrInContractCtrl"}).when("/contractmgr/incontract/:customId",{templateUrl:fdRouterViewsBasepath+"contract/views/contractmgrincontract.html",controller:"ContractMgrInContractCtrl"}).when("/contractmgr/editcontract/:id",{templateUrl:fdRouterViewsBasepath+"contract/views/contractmgrincontract.html",controller:"ContractMgrInContractCtrl"}).when("/contractmgr/viewcontract/:id",{templateUrl:fdRouterViewsBasepath+"contract/views/contractmgrviewcontract.html",controller:"ContractMgrViewContractCtrl"}).when("/invoicemgr/list",{templateUrl:fdRouterViewsBasepath+"invoice/views/invoicemgrlist.html",controller:"InvoiceMgrListCtrl"}).when("/invoicemgr/ininvoice",{templateUrl:fdRouterViewsBasepath+"invoice/views/invoicemgrininvoice.html",controller:"InvoiceMgrInInvoiceCtrl"}).when("/invoicemgr/editcustom/:id",{templateUrl:fdRouterViewsBasepath+"invoice/views/invoicemgrininvoice.html",controller:"InvoiceMgrInInvoiceCtrl"}).when("/invoicemgr/viewinvoice/:id",{templateUrl:fdRouterViewsBasepath+"custom/views/invoicemgrviewinvoice.html",controller:"InvoiceMgrViewInvoiceCtrl"}).when("/performancemgr/list",{templateUrl:fdRouterViewsBasepath+"performance/views/performancemgrlist.html",controller:"PerformanceMgrListCtrl"}).when("/teammgr/list",{templateUrl:fdRouterViewsBasepath+"team/views/teammgrlist.html",controller:"TeamMgrListCtrl"}).when("/teammgr/myinfo",{templateUrl:fdRouterViewsBasepath+"team/views/teammgrmyinfo.html",controller:"TeamMgrMyInfoCtrl"}).when("/usermgr/list",{templateUrl:fdRouterViewsBasepath+"user/views/usermgrlist.html",controller:"UserMgrListCtrl"}).when("/usermgr/inuser",{templateUrl:fdRouterViewsBasepath+"user/views/usermgrinuser.html",controller:"UserMgrInUserCtrl"}).when("/usermgr/editcustom/:id",{templateUrl:fdRouterViewsBasepath+"user/views/usermgrinuser.html",controller:"UserMgrInUserCtrl"}).when("/usermgr/viewuser/:id",{templateUrl:fdRouterViewsBasepath+"user/views/usermgrviewuser.html",controller:"UserMgrViewUserCtrl"}).when("/usermgr/resetpwd",{templateUrl:fdRouterViewsBasepath+"user/views/userresetpwd.html",controller:"UserResetPwdCtrl"}).when("/pubmgr/list",{templateUrl:fdRouterViewsBasepath+"pub/views/pubmgrlist.html",controller:"PubMgrListCtrl"}).when("/pubmgr/inpub",{templateUrl:fdRouterViewsBasepath+"pub/views/pubmgrinpub.html",controller:"PubMgrInPubCtrl"}).when("/pubmgr/editpub",{templateUrl:fdRouterViewsBasepath+"pub/views/pubmgreditpub.html",controller:"PubMgrEditPubCtrl"}).otherwise({redirectTo:"/"})}]),app.filter("trustHtml",function(e){return function(t){return e.trustAsHtml(t)}}),app.directive("coreBasedata",["$http",function(){var e={customIndustry:[["房地产开发/建筑与工程","房地产开发/建筑与工程"],["金融业(投资/保险/证券/银行/基金)","金融业(投资/保险/证券/银行/基金)"]],customSource:[["广告呼入","广告呼入"],["主动BD","主动BD"],["机构合作","机构合作"],["人脉推荐","人脉推荐"]],customState:[["潜在客户","潜在客户"],["签约运作","签约运作"],["签约暂停","签约暂停"],["签约终止","签约终止"]],contractState:[["运作","运作"],["暂停","暂停"],["终止","终止"]],jobState:[["运作","运作"],["结束","结束"],["暂停","暂停"],["关闭","关闭"]],zone:[["北京","北京"],["上海","上海"],["广州","广州"]],duty:[["经营管理类","经营管理类"],["财务/审计/统计类","财务/审计/统计类"],["人力资源类","人力资源类"]],edu:[["博士以上","博士以上"],["硕士以上","硕士以上"],["本科以上","本科以上"],["大专以上","大专以上"]],yearpay:[["10万以下","10万以下"],["10-15万","10-15万"],["15-20万","15-20万"],["20-30万","20-30万"],["30-50万","30-50万"],["50-100万","50-100万"],["100-150万","100-150万"],["150-200万","150-200万"],["200万以上","200万以上"]],department:[["猎头部","猎头部"],["技术部","技术部"],["人力资源部","人力资源部"],["财务部","财务部"],["行政部","行政部"],["市场部","市场部"],["管理中心","管理中心"]],userduty:[["猎头助理","猎头助理"],["猎头顾问","猎头顾问"],["合伙人","合伙人"],["人力资源","人力资源"],["资深顾问","资深顾问"],["财务出纳","财务出纳"],["工程师","工程师"],["助理顾问","助理顾问"]],incomestate:[["已到账","已到账"],["未到账","未到账"]],invoicetype:[["普通发票","普通发票"],["专用发票","专用发票"]],invoicestate:[["申请中","申请中"],["已开出","已开出"],["已作废","已作废"]]};e.inyear=[];for(var t=5,r=(new Date).getFullYear(),a=0;t>a;a++)e.inyear.push([""+(r-a),""+(r-a)+"年"]);return{restrict:"A",scope:{value:"@value",type:"@type",key:"@key",name:"@dataname",bindModel:"=",allSelectName:"@allSelectName"},templateUrl:"static/app/components/directives/core/views/basedata.html",replace:!0,require:"?ngModel",link:function(t,r,a,s){t.items=e[t.key],t.click=function(e,t){if(s.$setViewValue(e),t){var r=$(t);r.siblings().removeClass("select"),r.addClass("select")}},t.select=function(e){t.bindModel=e.bindModel}}}}]),app.directive("coreCustomselect",["$http",function(e){return{restrict:"A",replace:!0,scope:{customid:"=customid"},require:"ngModel",templateUrl:"static/app/components/directives/core/views/customselect.html",link:function(t,r,a,s){var o=!1;t.ok=function(e){t.customname=e.custom_name,s.$setViewValue(e)},t.$watch("customid",function(r){r&&(o||(o=!0,e.post("custom/getCustomById",{id:r}).success(function(e){e.custom&&(t.customname=e.custom.customName)})))},!0),t.$watch("customsearch",function(r,a){r!=a&&e.post("custom/list",{companyName:r,page:1,rows:100,customStatus:"签约运作"}).success(function(e){t.customs=e.rows})},!0)}}}]),app.directive("coreFileupload",["$http",function(e){return{restrict:"A",scope:{attas:"=attas"},require:"?ngModel",templateUrl:"static/app/components/directives/core/views/fileupload.html",link:function(t,r,a,s){function o(e){var t="";if(e&&e.length>0)for(var r=0;r<e.length;r++)t+=e[r].id,r!=e.length-1&&(t+=",");return t}function n(e){var r=[];for(var a in t.attas){var s=t.attas[a];s.id!=e&&r.push(s)}t.attas=r}t.$watch("attaresult",function(){var e=t.attaresult;t.attaformresult=e,e&&"1"==e.success&&(t.attas||(t.attas=[]),t.attas.push(e.data),s.$setViewValue(o(t.attas)))}),t.delAttach=function(r){e.post("fileDel",{id:r.id}).success(function(e){t.attaformresult=e,n(r.id),s.$setViewValue(o(t.attas))})}}}}]),app.directive("coreFormresult",["$timeout",function(e){var t=null;return{restrict:"A",scope:{formresult:"=result"},templateUrl:"static/app/components/directives/core/views/formresult.html",link:function(r){r.$watch("formresult",function(){null!=r.formresult&&"1"==r.formresult.success&&(e.cancel(t),t=e(function(){r.formresult=null},4e3),r.$on("$destroy",function(){e.cancel(t)}))})}}}]),app.directive("coreFu",["$http",function(){return{restrict:"A",require:"?ngModel",link:function(e,t,r,a){var s={dataType:"json",url:"fileUpload"};s.started=function(){e.$apply(function(){a.$setViewValue({success:"0",message:"上传中..."})})},s.done=function(t,r){e.$apply(function(){a.$setViewValue(r.result)})},s.fail=function(){e.$apply(function(){a.$setViewValue({success:"0",message:"上传失败"})})},t.fileupload(s)}}}]),app.directive("corePermission",["BaseInfoService",function(e){return{restrict:"A",link:function(t,r,a){var s=r.style.display;r.style.display="none",e.getUserInfo(function(e){var t=!1,o=!1,n=e.userType;if("1"!=n){var i=a.roles.split(",");if(i.length>0)for(var u in i){var c=i[u];if(c==n){t=!0;break}}{a.funid}o=!0,t&&o&&(r.style.display=s)}else r.style.display=s})}}}]),app.directive("coreTeamselect",["$http",function(e){return{restrict:"A",replace:!0,scope:{teamids:"=teamids",single:"=single",name:"@dataname"},require:"ngModel",templateUrl:"static/app/components/directives/core/views/teamselect.html",link:function(t,r,a,s){function o(){var e=[],r=t.select;for(var a in r)e.push(r[a].id);t.selectteamsFlag=e.join(","),s.$setViewValue(e.join(","))}var n=t.single?t.single:!1,i=!1;t.addItem=function(e){t.select||(t.select=[]),n&&(t.select=[]),t.select.push(e),o()},t.removeItem=function(e,r){t.select.splice(r,1),o()},t.$watch("teamids",function(r){r&&(i||(i=!0,e.post("team/getSelectTeams",{ids:r}).success(function(e){t.select=e;var r=[];for(var a in e)r.push(e[a].id);t.selectteamsFlag=r.join(",")})))},!0),t.$watch("teamsearch",function(r,a){r!=a&&e.post("team/list",{name:r,page:1,rows:100}).success(function(e){t.teams=e.rows})},!0)}}}]),angular.module("datepicker",[]).directive("datepicker",[function(){return{restrict:"A",require:"ngModel",link:function(e,t,r,a){$(function(){t.datepicker({dateFormat:"yy-mm-dd",onSelect:function(t){e.$apply(function(){a.$setViewValue(t)})}})})}}}]),app.factory("BaseInfoService",["$http","ngTableParams",function(e,t){var r=null;return{getUserInfo:function(t){r?data&&t(data):e.post("getLoginUser").success(function(e){e&&t(e)})},pageSearch:function(r){var a=r.$scope,s=r.params,o=r.url,n=r.page;void 0==n&&(n=10);r.items;s||(a[s]={});var i=new t({page:0,count:n},{total:0,getData:function(t,r){a[s].isreload?a[s].isreload=!1:(a[s].page=r.page(),a[s].rows=r.count(),a[s].total=r.total()),e.post(o,a[s]).success(function(e){var o=e.total;a[s].total=o,r.total(o),t.resolve(e.rows)})}});return i}}}]),app.controller("ContractMgrInContractCtrl",function(e,t,r,a,s){function o(r){n()&&(e.isrequest=!0,e.contract.customId=e.custom.id,t.post("contract/edit",e.contract).success(function(t){e.formresult=t,e.isrequest=!1,r&&r(t)}))}function n(){return $("#contracteditform").isHappy({fields:{customName:{required:!0},no:{required:!0,maxlength:100},state:{required:!0,maxlength:50},inDate:{required:!0,date:!0},inPercentage:{required:!0,maxlength:100},payway:{required:!0,maxlength:100},firstPay:{required:!0,number:!0},useLimit:{required:!0,maxlength:50},otherRequire:{maxlength:500}}})}s.menu="contract";var i=r.id,u=r.customId;e.isReady=!1,u&&t.post("custom/getCustomById",{id:u}).success(function(t){e.custom=t.custom,e.isReady=!0}),i&&t.post("contract/getContractViewById",{id:i}).success(function(t){e.custom=t.custom,e.contract=t.contract,e.attachs=t.attachs,e.isReady=!0}),i||u||(e.isReady=!0),e.save=function(){o(function(e){"1"==e.success&&$location.path("contractmgr/list")})}}),app.controller("ContractMgrListCtrl",function(e,t,r,a,s){s.menu="contract";var o=1,n=10;e.search={},e.queryParams={rows:n},e.initParams=function(t){var r=o;t&&(r=e.queryParams.page);var a={page:r,rows:e.queryParams.rows,isreload:!0};angular.extend(a,e.search),angular.extend(e.queryParams,a)},e.initParams(),e.reload=function(t){e.initParams(t),e.tableParams.reload()},e.tableParams=new a({page:o,count:n},{total:0,getData:function(r,a){e.queryParams.isreload?e.queryParams.isreload=!1:(e.queryParams.page=a.page(),e.queryParams.rows=a.count(),e.queryParams.total=a.total()),t.post("contract/list",e.queryParams).success(function(t){var s=t.total;e.queryParams.total=s,a.total(s),a.page(e.queryParams.page),r.resolve(t.rows)})}}),e.$watch("search",function(t,r){t!=r&&e.reload()},!0),e.del=function(r){t.post("contract/del",{id:r.id}).success(function(t){e.formresult=t,e.reload(!0)})}}),app.controller("ContractMgrViewContractCtrl",function(e,t,r,a,s){s.menu="contract";var o=r.id;e.isReady=!1,t.post("contract/getContractViewById",{id:o}).success(function(t){e.custom=t.custom,e.contract=t.contract,e.jobs=t.jobs,e.isReady=!0})}),app.factory("ContractService",["$http",function(e){return{test:function(t,r){e.post("formdesign/formdatadel",t).success(function(e){r&&r(e)})}}}]),app.factory("FormDataListService",["$http",function(e){return{queryList:function(t,r){e.post("formdesign/getformdatas",t).success(function(e){var t=[],a=e.pagingResult.rows;if(a&&a.length>0)for(var s in a){var o=a[s];t.push({id:o.id,dt_create:o.dt_create,form_data:JSON.parse(o.form_data)})}e.pagingResult.rows=t,r&&r(e)})}}}]),app.factory("FormDataService",["$http",function(e){return{del:function(t,r){e.post("formdesign/formdatadel",t).success(function(e){r&&r(e)})}}}]),app.factory("FormDesignListService",["$http",function(e){return{queryList:function(t,r){e.post("formdesign/getforms",t).success(function(e){r&&r(e)})}}}]),app.factory("FormDesignService",["$http",function(e){return{queryFormById:function(t,r){e.post("formdesign/getformbyid",t).success(function(e){var t=JSON.parse(e.formResult.data.fields),a=[],s=5,o=0;$.each(t,function(e,t){return o>=s?!1:(o++,void(t&&t.fielddesc&&a.push({name:e,desc:t.fielddesc})))}),e.formFields=a,r&&r(e)})},del:function(t,r){e.post("formdesign/del",t).success(function(e){r&&r(e)})},pub:function(t,r){e.post("formdesign/pub",t).success(function(e){r&&r(e)})},canclepub:function(t,r){e.post("formdesign/canclepub",t).success(function(e){r&&r(e)})}}}]),app.controller("FormDataListCtrl",function(e,t,r,a,s,o,n){var i=1,u=10;e.initParams=function(){e.queryParams={page:i,rows:u,formid:r.formid,isreload:!0}},e.initParams(),e.reload=function(){e.initParams(),e.tableParams.reload()},e.tableParams=new a({page:i,count:u},{total:0,getData:function(t,r){e.queryParams.isreload?e.queryParams.isreload=!1:(e.queryParams.page=r.page(),e.queryParams.rows=r.count(),e.queryParams.total=r.total()),s.queryList(e.queryParams,function(a){var s=a.pagingResult.total;e.queryParams.total=s,r.total(s),t.resolve(a.pagingResult.rows)})}}),e.del=function(t){confirm("确认删除?")!==!1&&(t.isdeling=!0,n.del({id:t.id},function(){e.reload()}))},o.queryFormById({id:r.formid},function(t){e.formtitle=t.formResult.data.title,e.formdtcreate=t.formResult.data.dtCreate,e.formdtupdate=t.formResult.data.dtUpdate,e.formdtpub=t.formResult.data.dtPub,e.formFields=t.formFields})}),app.controller("FormDesignCtrl",function(e,t,r){function a(e,t){var r=/(\|-<span(((?!<span).)*plugins=\"(radios|checkboxs|select)\".*?)>(.*?)<\/span>-\||<(img|input|textarea|select).*?(<\/select>|<\/textarea>|\/>))/gi,a=/(\w+)=\"(.?|.+?)\"/gi,s=/<input.*?\/>/gi;t||(t=0);var o=e,n=new Array,i=new Object,u=0,c=0;e.replace(r,function(r,l,m,d,p,f,g){var y=new Array,h=new Object,v="",w="",q=!1,b=r,P=g?g:p;if("radios"==P||"checkboxs"==P?r=m:"select"==P&&(r=r.replace("|-",""),r=r.replace("-|","")),r.replace(a,function(e,r,a){"name"==r&&("NEWFIELD"==a&&(q=!0,t++,a="data_"+t),v=a),"select"==P&&"value"==r?(h[r]||(h[r]=""),h[r]+=w+a,w=","):h[r]=a;var s=new Object;s[r]=a,y.push(s)}),"checkboxs"==P){r=b,r=r.replace("|-",""),r=r.replace("-|","");var v="checkboxs_"+u;h.parse_name=v,h.name="",h.value="",h.content='<span plugins="checkboxs" valids="'+h.valids+'">';var C="",x="";f.replace(s,function(e){var r=!1,s=new Object;e.replace(a,function(e,a,o){"name"==a?("NEWFIELD"==o&&(r=!0,t++,o="data_"+t),h.name+=C+o,C=","):"value"==a&&(h.value+=x+o,x=","),s[a]=o}),h.options||(h.options=new Array),h.options.push(s),s.checked||(s.checked="");var o=s.checked?'checked="checked"':"";if(h.content+='<input type="checkbox" name="'+s.name+'" value="'+s.value+'" fieldname="'+h.fieldname+s.fieldname+'"'+o+"/>"+s.value+"&nbsp;",r){var n=new Object;n.name=s.name,n.plugins=h.plugins,n.fieldname=h.fieldname+s.fieldname,n.fielddesc=h.orgdesc,n.valids=h.valids,i[s.name]=n}}),h.content+="</span>",e=e.replace(r,h.content),o=o.replace(r,"{"+v+"}"),o=o.replace("{|-",""),o=o.replace("-|}",""),n[c]=h,u++}else if(v){if("radios"==P){r=b,r=r.replace("|-",""),r=r.replace("-|",""),h.value="",h.content='<span plugins="radios" name="'+h.name+'" valids="'+h.valids+'">';var R="";f.replace(s,function(e){var t=new Object;e.replace(a,function(e,r,a){"value"==r&&(h.value+=R+a,R=","),t[r]=a}),t.name=h.name,h.options||(h.options=new Array),h.options.push(t),t.checked||(t.checked="");var r=t.checked?'checked="checked"':"";h.content+='<input type="radio" name="'+h.name+'" value="'+t.value+'"  '+r+"/>"+t.value+"&nbsp;"}),h.content+="</span>"}else h.content=q?r.replace(/NEWFIELD/,v):r;if(e=e.replace(r,h.content),o=o.replace(r,"{"+v+"}"),o=o.replace("{|-",""),o=o.replace("-|}",""),q){var I=new Object;I.name=v,I.plugins=h.plugins,I.orgtype=h.orgtype,I.fieldname=h.fieldname,I.fielddesc=h.orgdesc,I.valids=h.valids,i[I.name]=I}n[c]=h}c++});var l=e.replace(/{\|-/g,"");l=l.replace(/-\|}/g,"");var m=new Object({fields:t,template:e,parse:l,data:n,add_fields:i});return JSON.stringify(m)}t.id&&(e.id=t.id),UE.delEditor("formdesigncontainer");var s=null;s=UE.getEditor("formdesigncontainer",{toolleipi:!0,initialFrameWidth:1024,initialFrameHeight:200,enableAutoSave:!1,enableContextMenu:!0,toolbars:[["fullscreen","undo","redo","|","bold","italic","underline","fontborder","strikethrough","removeformat","|","forecolor","backcolor","insertorderedlist","insertunorderedlist","|","fontfamily","fontsize","|","indent","|","justifyleft","justifycenter","justifyright","justifyjustify","|","link","unlink","|","horizontal","spechars","wordimage","|","inserttable","deletetable","mergecells","splittocells","|"]],wordCount:!1,elementPathEnabled:!1}),s.addListener("ready",function(){t.id&&r.post("formdesign/getformbyid",{id:t.id}).success(function(t){e.title=t.formResult.data.title,s.execCommand("focus"),s.setContent(t.formResult.data.contentSrc)})}),e.exec=function(e){s.execCommand(e)},e.save=function(){if(0!=confirm("确认保存?注意：保存之后原始表单以及对应表单已上报数据会清空。")){if(s.queryCommandState("source")&&s.execCommand("source"),void 0===e.title)return void alert("标题不能为空");if(e.title.length>50)return void alert("标题长度不能大于50个字符");if(s.hasContents()){s.sync();var t=s.getContent(),o=JSON.parse(a(t,0));e.issaving=!0,r.post("formdesign/add",{title:e.title,content:o.parse,contentSrc:t,fields:JSON.stringify(o.add_fields),id:e.id}).success(function(t){"0"==t.formResult.success?alert(t.formResult.message):(e.id=t.formResult.data,alert("保存成功")),e.issaving=!1}).error(function(){alert("保存失败"),e.issaving=!1})}else alert("内容不能为空")}},e.preview=function(){if(s.queryCommandState("source")&&s.execCommand("source"),!s.hasContents())return alert("内容不能为空！"),!1;s.sync();var t=s.getContent(),r=a(t,0);e.designZone=JSON.parse(r).parse,e.isDesignZoneActive=!0}}),app.controller("FormDesignListCtrl",function(e,t,r,a,s){e.reset=function(){e.searchTitle=null,e.dtCreateBegin=null,e.dtCreateEnd=null,e.dtPubBegin=null,e.dtPubEnd=null,e.ispub=null,e.pubtype=null};var o=1,n=10;e.queryParams={page:o,rows:n,isreload:!0},e.reload=function(){e.queryParams={page:e.queryParams.page,rows:e.queryParams.rows,dtcreate_begin:e.dtCreateBegin,dtcreate_end:e.dtCreateEnd,dtpub_begin:e.dtPubBegin,dtpub_end:e.dtPubEnd,ispub:e.ispub,title:e.searchTitle,pubtype:e.pubtype,isreload:!0},e.tableParams.reload()},e.tableParams=new r({page:o,count:n},{total:0,getData:function(t,r){e.queryParams.isreload?e.queryParams.isreload=!1:(e.queryParams.page=r.page(),e.queryParams.rows=r.count(),e.queryParams.total=r.total()),a.queryList(e.queryParams,function(a){var s=a.pagingResult.total;e.queryParams.total=s,r.total(s),t.resolve(a.pagingResult.rows)})}}),e.pub=function(t,r){s.pub({id:t,type:r},function(){e.reload()})},e.canclepub=function(t){s.canclepub({id:t},function(){e.reload()})},e.del=function(t){confirm("确认删除?")!==!1&&(t.isdeling=!0,s.del({id:t.id},function(){e.reload()}))}}),app.controller("CustomMgrInCustomCtrl",function(e,t,r,a,s,o){function n(){t.post("custom/getCommuns",{customId:c}).success(function(t){e.communs=t})}function i(r){u()&&(e.isrequest=!0,t.post("custom/edit",e.custom).success(function(t){e.formresult=t,e.isrequest=!1,r&&r(t)}))}function u(){return $("#customeditform").isHappy({fields:{customName:{required:!0,maxlength:100},industry:{required:!0,maxlength:200},team:{required:!0},contactName:{required:!0,maxlength:100},contactDuty:{required:!0,maxlength:100},contactLandline:{maxlength:100},contactCellphone:{required:!0,maxlength:100},contactFax:{maxlength:100},contactEmail:{required:!0,maxlength:100},contactQq:{maxlength:100},contactWeixin:{maxlength:100},contactAddress:{maxlength:200},contactWebsite:{maxlength:100},companyProfile:{maxlength:100},commun:{maxlength:500}}})}s.menu="custom";var c=r.id;e.isReady=!1,c?t.post("custom/getCustomById",{id:c}).success(function(t){e.custom=t.custom,e.communs=t.communs,e.attachs=t.attachs,e.isReady=!0}):(e.isReady=!0,e.custom={state:"潜在客户"}),e.delCommun=function(r){t.post("custom/delCommun",{id:r.id}).success(function(t){e.formresult=t,n()})},e.save=function(){i(function(e){"1"==e.success&&o.path("custommgr/viewcustom/"+c)})},e.saveAndAddContract=function(){i(function(e){if("1"==e.success){var t=e.data;o.path("contractmgr/incontract/"+t)}})}}),app.controller("CustomMgrListCtrl",function(e,t,r,a,s){s.menu="custom";var o=1,n=10;e.search={},e.queryParams={rows:n},e.initParams=function(t){var r=o;t&&(r=e.queryParams.page);var a={page:r,rows:e.queryParams.rows,isreload:!0};angular.extend(a,e.search),angular.extend(e.queryParams,a)},e.initParams(),e.reload=function(t){e.initParams(t),e.tableParams.reload()},e.tableParams=new a({page:o,count:n},{total:0,getData:function(r,a){e.queryParams.isreload?e.queryParams.isreload=!1:(e.queryParams.page=a.page(),e.queryParams.rows=a.count(),e.queryParams.total=a.total()),t.post("custom/list",e.queryParams).success(function(t){var s=t.total;e.queryParams.total=s,a.total(s),a.page(e.queryParams.page),r.resolve(t.rows)})}}),e.$watch("search",function(t,r){t!=r&&e.reload()},!0),e.del=function(r){t.post("custom/del",{id:r.id}).success(function(t){e.formresult=t,e.reload(!0)})},e.changeSelect=function(e){$(e).siblings().removeClass("select"),$(e).addClass("select")}}),app.controller("CustomMgrViewCustomCtrl",function(e,t,r,a,s){s.menu="custom";var o=r.id;e.isReady=!1,e.reload=function(){t.post("custom/getCustomViewById",{id:o}).success(function(t){e.custom=t.custom,e.comms=t.comms?t.comms:[],e.attas=t.attas,e.jobs=t.jobs,e.teams=t.teams,e.beyond=t.beyond,t.contracts&&t.contracts.length>0&&(e.contract=t.contracts[0]),e.contractAttas=t.contractAttas,e.isReady=!0})},e.reload(),e.addComm=function(){$("#addCommForm").isHappy({fields:{addContent:{required:!0,maxlength:500}}})&&t.post("custom/addCommun",{customId:e.custom.id,content:e.addContent}).success(function(t){e.reload(),e.formresult=t})}}),app.controller("InvoiceMgrInInvoiceCtrl",function(e,t,r,a,s){function o(r){n()&&(e.isrequest=!0,t.post("invoice/edit",e.invoice).success(function(t){e.formresult=t,e.isrequest=!1,r&&r(t)}))}function n(){return $("#invoiceeditform").isHappy({fields:{team:{required:!0},checkUser:{required:!0},applyTime:{required:!0,date:!0},customContract:{required:!0,maxlength:100},type:{required:!0,maxlength:50},property:{required:!0,maxlength:100},total:{required:!0,number:!0},state:{required:!0,maxlength:100},incomeState:{required:!0,maxlength:50},comment:{maxlength:500}}})}s.menu="invoice";var i=r.id;e.isReady=!1,i?t.post("invoice/getInvoiceViewById",{id:i}).success(function(t){e.invoice=t.invoice,e.isReady=!0}):e.isReady=!0,e.delCommun=function(r){t.post("invoice/del",{id:r.id}).success(function(t){e.formresult=t})},e.save=function(){o(function(t){e.formresult=t})}}),app.controller("InvoiceMgrListCtrl",function(e,t,r,a,s){s.menu="invoice";var o=1,n=10;e.search={},e.queryParams={rows:n},e.initParams=function(t){var r=o;t&&(r=e.queryParams.page);var a={page:r,rows:e.queryParams.rows,isreload:!0};angular.extend(a,e.search),angular.extend(e.queryParams,a)},e.initParams(),e.reload=function(t){e.initParams(t),e.tableParams.reload()},e.tableParams=new a({page:o,count:n},{total:0,getData:function(r,a){e.queryParams.isreload?e.queryParams.isreload=!1:(e.queryParams.page=a.page(),e.queryParams.rows=a.count(),e.queryParams.total=a.total()),t.post("invoice/list",e.queryParams).success(function(t){var s=t.total;e.queryParams.total=s,a.total(s),a.page(e.queryParams.page),r.resolve(t.rows)})}}),e.$watch("search",function(t,r){t!=r&&e.reload()},!0),e.del=function(r){t.post("invoice/del",{id:r.id}).success(function(t){e.formresult=t,e.reload(!0)})}}),app.controller("InvoiceMgrViewInvoiceCtrl",function(e,t,r,a,s){s.menu="invoice";var o=r.id;e.isReady=!1,t.post("invoice/getInvoiceViewById",{id:o}).success(function(t){e.invoice=t.invoice,e.isReady=!0})}),app.controller("IndexCtrl",function(e,t,r,a,s){s.menu="#",e.isRequest=!0,t.post("index/getIndex",{}).success(function(t){e.data=t,e.isRequest=!1})}),app.controller("JobMgrInJobCtrl",function(e,t,r,a,s,o){function n(r){i()&&(e.isrequest=!0,e.job.customId=e.custom.id,t.post("job/edit",e.job).success(function(t){e.formresult=t,e.isrequest=!1,r&&r(t)}))}function i(){return $("#jobeditform").isHappy({fields:{customName:{required:!0,maxlength:500},name:{required:!0,maxlength:100},payMin:{number:!0},payMax:{number:!0},state:{required:!0},team:{required:!0},workplace:{required:!0,maxlength:200},jobType:{required:!0,maxlength:100},industry:{required:!0,maxlength:200},workYear:{required:!0,digits:!0},requirePeople:{required:!0,digits:!0},department:{required:!0,maxlength:100},reportObj:{required:!0,maxlength:100},ageMin:{required:!0,digits:!0},ageMax:{required:!0,digits:!0},languageLimit:{maxlength:100},jobDesc:{required:!0,maxlength:500},companyDesc:{required:!0,maxlength:500}}})}s.menu="job";var u=r.id,c=r.customId;e.isReady=!1,u?t.post("job/getJobViewById",{id:u}).success(function(t){e.job=t.job,e.custom=t.custom,e.isReady=!0}):c?(t.post("custom/getCustomById",{id:c}).success(function(t){e.custom=t.custom,e.isReady=!0}),e.job={state:"运作",sexLimit:"不限"}):(e.isReady=!0,e.job={state:"运作",sexLimit:"不限"}),e.save=function(){n(function(e){"1"==e.success&&o.path(c?"custommgr/viewcustom/"+c:"jobmgr/list")})}}),app.controller("JobMgrListCtrl",function(e,t,r,a,s){s.menu="job";var o=1,n=10;e.search={},e.queryParams={rows:n},e.initParams=function(t){var r=o;t&&(r=e.queryParams.page);var a={page:r,rows:e.queryParams.rows,isreload:!0};angular.extend(a,e.search),angular.extend(e.queryParams,a)},e.initParams(),e.reload=function(t){e.initParams(t),e.tableParams.reload()},e.tableParams=new a({page:o,count:n},{total:0,getData:function(r,a){e.queryParams.isreload?e.queryParams.isreload=!1:(e.queryParams.page=a.page(),e.queryParams.rows=a.count(),e.queryParams.total=a.total()),t.post("job/list",e.queryParams).success(function(t){var s=t.total;e.queryParams.total=s,a.total(s),a.page(e.queryParams.page),r.resolve(t.rows)})}}),e.$watch("search",function(t,r){t!=r&&e.reload()},!0),e.del=function(r){t.post("job/del",{id:r.id}).success(function(t){e.formresult=t,e.reload(!0)})},e.changeSelect=function(e){$(e).siblings().removeClass("select"),$(e).addClass("select")}}),app.controller("JobMgrViewJobCtrl",function(e,t,r,a,s){s.menu="job";var o=r.id;e.isReady=!1;var n=function(){t.post("job/getJobViewById",{id:o}).success(function(t){e.job=t.job,e.custom=t.custom,e.inteams=t.inteamresumes,e.pubresumes=t.pubresumes,e.jobcomms=t.jobcomms,e.isReady=!0})};n(),e.pubResume=function(r){t.post("job/pubResume",{rjId:r}).success(function(t){e.formresult=t,1==t.success&&n()})},e.cancleResume=function(r){t.post("job/cancleResume",{rjId:r}).success(function(t){e.formresult=t,1==t.success&&n()})},e.verify=function(r,a){t.post("job/verifyResume",{rjId:r,status:a}).success(function(t){e.formresult=t,1==t.success&&n()})},e.addComm=function(){t.post("job/editJobComm",{jobId:o,content:e.addcomm}).success(function(t){e.formresult=t,1==t.success&&n()})},e.delComm=function(r){t.post("job/delJobComm",{id:r}).success(function(t){e.formresult=t,1==t.success&&n()})}}),app.factory("JobService",["$http",function(e){return{test:function(t,r){e.post("formdesign/formdatadel",t).success(function(e){r&&r(e)})}}}]),app.controller("PerformanceMgrListCtrl",function(e,t,r,a,s,o){o.menu="performance";var n=1,i=10;e.search={},e.queryParams={rows:i},e.initParams=function(t){var r=n;t&&(r=e.queryParams.page);var a={page:r,rows:e.queryParams.rows,isreload:!0};angular.extend(a,e.search),angular.extend(e.queryParams,a)},e.initParams(),e.reload=function(t){e.initParams(t),e.tableParams.reload()},e.tableParams=new a({page:n,count:i},{total:0,getData:function(r,a){e.queryParams.isreload?e.queryParams.isreload=!1:(e.queryParams.page=a.page(),e.queryParams.rows=a.count(),e.queryParams.total=a.total()),t.post("performance/list",e.queryParams).success(function(t){var s=t.total;e.queryParams.total=s,a.total(s),a.page(e.queryParams.page),r.resolve(t.rows)})}}),e.$watch("search",function(t,r){t!=r&&e.reload()},!0)}),app.factory("PerformanceService",["$http",function(e){return{test:function(t,r){e.post("formdesign/formdatadel",t).success(function(e){r&&r(e)})}}}]),app.controller("PubMgrInPubCtrl",function(e,t,r,a,s){s.menu="pub"}),app.controller("PubMgrListCtrl",function(e,t,r,a,s){s.menu="pub";var o=1,n=10;e.search={},e.queryParams={rows:n},e.initParams=function(t){var r=o;t&&(r=e.queryParams.page);var a={page:r,rows:e.queryParams.rows,isreload:!0};angular.extend(a,e.search),angular.extend(e.queryParams,a)},e.initParams(),e.reload=function(t){e.initParams(t),e.tableParams.reload()},e.tableParams=new a({page:o,count:n},{total:0,getData:function(r,a){e.queryParams.isreload?e.queryParams.isreload=!1:(e.queryParams.page=a.page(),e.queryParams.rows=a.count(),e.queryParams.total=a.total()),t.post("pub/list",e.queryParams).success(function(t){var s=t.total;
e.queryParams.total=s,a.total(s),a.page(e.queryParams.page),r.resolve(t.rows)})}}),e.$watch("search",function(t,r){t!=r&&e.reload()},!0),e.del=function(r){t.post("pub/del",{id:r.id}).success(function(t){e.formresult=t,e.reload(!0)})},e.add=function(){$("#form-pub").isHappy({fields:{addcontent:{required:!0,maxlength:500}}})&&t.post("pub/edit",{content:e.addcontent}).success(function(t){e.addcontent=null,e.formresult=t,e.reload(!0)})},e.pub=function(r){t.post("pub/pubp",{id:r.id}).success(function(t){e.formresult=t,e.reload(!0)})},e.canclepub=function(r){t.post("pub/canclepub",{id:r.id}).success(function(t){e.formresult=t,e.reload(!0)})}}),app.factory("PubService",["$http",function(e){return{test:function(t,r){e.post("formdesign/formdatadel",t).success(function(e){r&&r(e)})}}}]),app.controller("ResumeMgrInResumeCtrl",function(e,t,r,a,s){function o(t,r){var a=[],s=e[t];for(var o in s){var n=s[o];n.id!=r&&a.push(n)}e[t]=a}s.menu="resume";var n=r.id;e.isReady=!1,e.target={targetTypeA:{all:!1,part:!1,learn:!1}},n?t.post("resume/getResumeViewById",{id:n}).success(function(t){e.resume=t.resume;var r=t.target;if(r&&r.length>0){var a=r[0];e.target={id:a.id,resumeId:a.resume_id,targetType:a.target_type,targetPlace:a.target_place,targetJob:a.target_job,targetIndustry:a.target_industry,targetPay:a.target_pay,workState:a.work_state},a.target_type&&(e.target.targetTypeA={all:!1,part:!1,learn:!1},-1!=a.target_type.indexOf("全职")&&(e.target.targetTypeA.all=!0),-1!=a.target_type.indexOf("兼职")&&(e.target.targetTypeA.part=!0),-1!=a.target_type.indexOf("实习")&&(e.target.targetTypeA.learn=!0))}e.resumeDatas=t.resumeDatas,e.resumeEdus=t.resumeEdus,e.resumeJobs=t.resumeJobs,e.resumeLanguages=t.resumeLanguages,e.resumeWorkhistorys=t.resumeWorkhistorys,e.isReady=!0}):(e.isReady=!0,e.target={},e.resumeDatas=[],e.resumeEdus=[],e.resumeJobs=[],e.resumeLanguages=[],e.resumeWorkhistorys=[]),e.saveBaseInfo=function(r){$("#resumeeditform-baseinfo").isHappy({fields:{name:{required:!0,maxlength:100},address:{required:!0,maxlength:200},sex:{required:!0,maxlength:10},education:{required:!0,maxlength:100},birthcay:{required:!0,date:!0},marrage:{required:!0,maxlength:20},phone:{required:!0,maxlength:100},email:{required:!0,maxlength:100},yearPay:{required:!0,number:!0},workState:{required:!0,maxlength:50},desc:{required:!0,maxlength:500}}})&&(e.isrequest=!0,t.post("resume/saveBaseinfo",e.resume).success(function(t){e.formresult=t,e.isrequest=!1,"1"==t.success&&(e.resume.id=t.data.id,r&&(e.show="target"))}))},e.saveTarget=function(r){if($("#resumeeditform-target").isHappy({fields:{worktype:{maxlength:100},targetPlace:{maxlength:100},targetJob:{maxlength:100},targetIndustry:{maxlength:100},targetPay:{maxlength:100},workState:{maxlength:100}}})){e.isrequest=!0,e.target.resumeId=e.resume.id;var a="";e.target.targetTypeA.all&&(a+="全职,"),e.target.targetTypeA.part&&(a+="兼职,"),e.target.targetTypeA.learn&&(a+="实习,"),e.target.targetType=a,t.post("resume/saveTarget",e.target).success(function(t){e.formresult=t,e.isrequest=!1,"1"==t.success&&(e.target.id=t.data.id,r&&(e.show="workhistory"))})}},e.saveWorkHistory=function(r){$("#resumeeditform-workhistory").isHappy({fields:{timeBegin:{required:!0},timeEnd:{required:!0},company:{required:!0,maxlength:100},content:{required:!0,maxlength:500}}})&&(e.isrequest=!0,e.workhistory.resumeId=e.resume.id,t.post("resume/saveWorkHistory",e.workhistory).success(function(t){if(e.formresult=t,e.isrequest=!1,"1"==t.success){var a=t.data;e.resumeWorkhistorys.push({id:a.id,resume_id:a.resumeId,time_begin:a.timeBegin,time_end:a.timeEnd,content:a.content,company:a.company}),e.workhistory={},r&&(e.show="eduhistory")}}))},e.delWorkHistory=function(r){t.post("resume/delWorkHistory",{id:r}).success(function(t){e.formresult=t,e.isrequest=!1,"1"==t.success&&o("resumeWorkhistorys",r)})},e.saveEduHistory=function(r){$("#resumeeditform-eduhistory").isHappy({fields:{timeBegin:{required:!0},timeEnd:{required:!0},org:{required:!0,maxlength:100},course:{required:!0,maxlength:500}}})&&(e.isrequest=!0,e.eduhistory.resumeId=e.resume.id,t.post("resume/saveEduHistory",e.eduhistory).success(function(t){if(e.formresult=t,e.isrequest=!1,"1"==t.success){var a=t.data;e.resumeEdus.push({id:a.id,resume_id:a.resumeId,time_begin:a.timeBegin,time_end:a.timeEnd,org:a.org,course:a.course,content:a.content}),e.eduhistory={},r&&(e.show="language")}}))},e.delEduHistory=function(r){t.post("resume/delEduHistory",{id:r}).success(function(t){e.formresult=t,e.isrequest=!1,"1"==t.success&&o("resumeEdus",r)})},e.saveLanguage=function(r){$("#resumeeditform-language").isHappy({fields:{lanType:{required:!0,maxlength:100},readAb:{required:!0,maxlength:100},listenAb:{required:!0,maxlength:100},content:{required:!0,maxlength:500}}})&&(e.isrequest=!0,e.language.resumeId=e.resume.id,t.post("resume/saveLanguage",e.language).success(function(t){if(e.formresult=t,e.isrequest=!1,"1"==t.success){var a=t.data;e.resumeLanguages.push({id:a.id,resume_id:a.resumeId,lan_type:a.lanType,read_ab:a.readAb,listen_ab:a.listenAb,content:a.content}),e.language={},r&&(e.show="atta")}}))},e.delLanguage=function(r){t.post("resume/delLanguage",{id:r}).success(function(t){e.formresult=t,e.isrequest=!1,"1"==t.success&&o("resumeLanguages",r)})},e.saveIcon=function(r){$("#resumeeditform-icon").isHappy({fields:{}})&&(e.isrequest=!0,t.post("resume/saveIcon",{id:e.resume.id,iconPath:e.iconPath}).success(function(t){e.formresult=t,e.isrequest=!1,"1"==t.success&&r&&(e.show="atta")}))},e.uploadAttas=function(){$("#resumeeditform-atta").isHappy({fields:{}})&&(e.isrequest=!0,t.post("resume/uploadAttas",{id:e.resume.id,attas:e.attas}).success(function(t){e.formresult=t,e.isrequest=!1}))}}),app.controller("ResumeMgrListCtrl",function(e,t,r,a,s){s.menu="resume";var o=1,n=10;e.search={},e.queryParams={rows:n},e.initParams=function(t){var r=o;t&&(r=e.queryParams.page);var a={page:r,rows:e.queryParams.rows,isreload:!0};angular.extend(a,e.search),angular.extend(e.queryParams,a)},e.initParams(),e.reload=function(t){e.initParams(t),e.tableParams.reload()},e.tableParams=new a({page:o,count:n},{total:0,getData:function(r,a){e.queryParams.isreload?e.queryParams.isreload=!1:(e.queryParams.page=a.page(),e.queryParams.rows=a.count(),e.queryParams.total=a.total()),t.post("resume/list",e.queryParams).success(function(t){var s=t.total;e.queryParams.total=s,a.total(s),a.page(e.queryParams.page),r.resolve(t.rows)})}}),e.$watch("search",function(t,r){t!=r&&e.reload()},!0),e.del=function(r){t.post("resume/del",{id:r.id}).success(function(t){e.formresult=t,e.reload(!0)})}}),app.controller("ResumeMgrViewResumeCtrl",function(e,t,r,a,s){function o(t,r){var a=[],s=e[t];for(var o in s){var n=s[o];n.id!=r&&a.push(n)}e[t]=a}s.menu="resume";var n=r.id;e.isReady=!1,t.post("resume/getResumeViewById",{id:n}).success(function(t){e.resume=t.resume;var r=t.target;if(r&&r.length>0){var a=r[0];e.target={id:a.id,resumeId:a.resume_id,targetType:a.target_type,targetPlace:a.target_place,targetJob:a.target_job,targetIndustry:a.target_industry,targetPay:a.target_pay,workState:a.work_state}}e.resumeDatas=t.resumeDatas,e.resumeEdus=t.resumeEdus,e.resumeJobs=t.resumeJobs,e.resumeLanguages=t.resumeLanguages,e.resumeWorkhistorys=t.resumeWorkhistorys,e.resumeComms=t.resumeComms,e.isReady=!0}),e.addComm=function(){t.post("resume/addComm",{resumeId:e.resume.id,content:e.addcomm}).success(function(t){if(e.formresult=t,e.isrequest=!1,"1"==t.success){var r=t.data;e.resumeComms.push({id:r.id,resume_id:r.resumeId,content:r.content,create_time:r.createTime})}})},e.delComm=function(r){t.post("resume/delComm",{id:r}).success(function(t){e.formresult=t,e.isrequest=!1,"1"==t.success&&o("resumeComms",r)})}}),app.controller("ResumePubListCtrl",function(e,t,r,a,s){s.menu="resume";var o=r.id;e.resumeId=o;var n=1,i=10;e.search={},e.queryParams={rows:i},e.initParams=function(t){var r=n;t&&(r=e.queryParams.page);var a={page:r,rows:e.queryParams.rows,isreload:!0};angular.extend(a,e.search),angular.extend(e.queryParams,a)},e.initParams(),e.reload=function(t){e.initParams(t),e.tableParams.reload()},e.tableParams=new a({page:n,count:i},{total:0,getData:function(r,a){e.queryParams.isreload?e.queryParams.isreload=!1:(e.queryParams.page=a.page(),e.queryParams.rows=a.count(),e.queryParams.total=a.total()),t.post("resume/getCustomList",e.queryParams).success(function(t){var s=t.total;e.queryParams.total=s,a.total(s),a.page(e.queryParams.page),r.resolve(t.rows)})}}),e.$watch("search",function(t,r){t!=r&&e.reload()},!0),e.pub=function(r){t.post("resume/pub",{resumeId:o,jobId:r.id}).success(function(t){e.formresult=t,e.reload(!0)})},e.canclePub=function(r){t.post("resume/canclePub",{resumeId:o,jobId:r.id}).success(function(t){e.formresult=t,e.reload(!0)})}}),app.factory("ResumeService",["$http",function(e){return{test:function(t,r){e.post("formdesign/formdatadel",t).success(function(e){r&&r(e)})}}}]),app.controller("TeamMgrListCtrl",function(e,t,r,a,s){s.menu="team";var o=1,n=12;e.search={},e.queryParams={rows:n},e.initParams=function(t){var r=o;t&&(r=e.queryParams.page);var a={page:r,rows:e.queryParams.rows,isreload:!0};angular.extend(a,e.search),angular.extend(e.queryParams,a)},e.initParams(),e.reload=function(t){e.initParams(t),e.tableParams.reload()},e.tableParams=new a({page:o,count:n},{total:0,getData:function(r,a){e.queryParams.isreload?e.queryParams.isreload=!1:(e.queryParams.page=a.page(),e.queryParams.rows=a.count(),e.queryParams.total=a.total()),t.post("team/list",e.queryParams).success(function(t){var s=t.total;e.queryParams.total=s,a.total(s),a.page(e.queryParams.page),r.resolve(t.rows)})}}),e.$watch("search",function(t,r){t!=r&&e.reload()},!0)}),app.controller("TeamMgrMyInfoCtrl",function(e,t,r,a,s){s.menu="team"}),app.controller("UserMgrInUserCtrl",function(e,t,r,a,s){s.menu="user",t.id?(e.id=t.id,r.post("user/getUserById",{id:e.id}).success(function(t){t.createTime=null,t.updateTime=null,e.user=t})):a.getUserInfo(function(t){e.user={userType:"1"==t.userType?"2":"3"}}),e.saveUser=function(){e.formresult=null;var t=$("#usermgr-list-form").isHappy({fields:{loginName:{required:!0,maxlength:20,minlength:6,username:!0},userName:{required:!0,maxlength:20},birthday:{dateISO:!0},orgCode:{required:!0,maxlength:40},department:{required:!0,maxlength:100},comment:{maxlength:100}}});t&&(e.isrequest=!0,r.post("user/editUser",e.user).success(function(t){e.formresult=t,t.data&&(e.user.id=t.data.id),e.isrequest=!1}))}}),app.controller("UserMgrListCtrl",function(e,t,r,a,s){s.menu="user";var o=1,n=10;e.search={},e.queryParams={rows:n},e.initParams=function(t){var r=o;t&&(r=e.queryParams.page);var a={page:r,rows:e.queryParams.rows,isreload:!0};angular.extend(a,e.search),angular.extend(e.queryParams,a)},e.initParams(),e.reload=function(t){e.initParams(t),e.tableParams.reload()},e.tableParams=new a({page:o,count:n},{total:0,getData:function(t,a){e.queryParams.isreload?e.queryParams.isreload=!1:(e.queryParams.page=a.page(),e.queryParams.rows=a.count(),e.queryParams.total=a.total()),r.post("user/getUserList",e.queryParams).success(function(r){var s=r.total;e.queryParams.total=s,a.total(s),a.page(e.queryParams.page),t.resolve(r.rows)})}}),e.$watch("search",function(t,r){t!=r&&e.reload()},!0),e.delUser=function(t){confirm("确认删除?")!==!1&&r.post("user/delUser",{id:t.id}).success(function(){e.reload()})},e.disabledUser=function(t){confirm("确认锁定?")!==!1&&r.post("user/disabledUser",{id:t.id}).success(function(){e.reload()})},e.enableUser=function(t){r.post("user/enableUser",{id:t.id}).success(function(){e.reload()})},e.resetPwd=function(t){confirm("确认重置用户密码?")!==!1&&r.post("user/pwdReset",{id:t.id}).success(function(t){e.reload(),e.formresult=t})}}),app.controller("UserMgrViewUserCtrl",function(e,t,r,a,s){s.menu="user"}),app.controller("UserResetPwdCtrl",function(e,t,r,a){a.menu="resetpwd",e.resetPwd=function(){e.formresult=null;var r=$("#user-pwdreset-form").isHappy({fields:{oldPwd:{required:!0,pwd:!0},newPwd:{required:!0,pwd:!0},newPwdRepeat:{required:!0,pwd:!0}}});r&&(e.isrequest=!0,t.post("user/pwdChange",e.pwd).success(function(t){e.formresult=t,e.isrequest=!1}))}});